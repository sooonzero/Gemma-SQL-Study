## 새로 알게 된 것

## 범용적인 데이터 처리
### Find the percentage of shipable orders
`배송 가능한 주문의 비율을 확인하세요. 고객의 주소가 알려진 경우 주문이 배송 가능하다고 간주하세요.`

위 문제를 풀기위해 orders와 customers 테이블 값을 먼저 확인해보았다.

### orders
<div class="ResultsTable__container QuestionTables__preview-table"><table class="ResultsTable__table"><thead><tr class="ResultsTable__header-row"><th class="ResultsTable__header-cell">id</th><th class="ResultsTable__header-cell">cust_id</th><th class="ResultsTable__header-cell">order_date</th><th class="ResultsTable__header-cell">order_details</th><th class="ResultsTable__header-cell">total_order_cost</th></tr></thead><tbody><tr class="ResultsTable__row "><td class="ResultsTable__cell">1</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-03-04</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">100</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">2</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-03-01</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-03-07</td><td class="ResultsTable__cell">Skirt</td><td class="ResultsTable__cell">30</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">25</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">5</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-03-10</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">6</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Boats</td><td class="ResultsTable__cell">100</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">60</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">8</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-03-11</td><td class="ResultsTable__cell">Slipper</td><td class="ResultsTable__cell">20</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">9</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-03-01</td><td class="ResultsTable__cell">Jeans</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">10</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-03-09</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">11</td><td class="ResultsTable__cell">5</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">60</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">13</td><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">2019-03-11</td><td class="ResultsTable__cell">Slipper</td><td class="ResultsTable__cell">20</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">14</td><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">2019-02-01</td><td class="ResultsTable__cell">Shoes</td><td class="ResultsTable__cell">80</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">60</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">16</td><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Shirts</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">17</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Suit</td><td class="ResultsTable__cell">150</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">18</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Skirt</td><td class="ResultsTable__cell">30</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">19</td><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">2019-04-20</td><td class="ResultsTable__cell">Dresses</td><td class="ResultsTable__cell">200</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">20</td><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">2019-01-11</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">125</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">21</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-01</td><td class="ResultsTable__cell">Suit</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">22</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-02</td><td class="ResultsTable__cell">Skirt</td><td class="ResultsTable__cell">30</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">23</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-03</td><td class="ResultsTable__cell">Dresses</td><td class="ResultsTable__cell">50</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">24</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-04</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">25</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">25</td><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">2019-04-19</td><td class="ResultsTable__cell">Coat</td><td class="ResultsTable__cell">125</td></tr></tbody></table></div>


### customers
<div class="ResultsTable__container QuestionTables__preview-table"><table class="ResultsTable__table"><thead><tr class="ResultsTable__header-row"><th class="ResultsTable__header-cell">id</th><th class="ResultsTable__header-cell">first_name</th><th class="ResultsTable__header-cell">last_name</th><th class="ResultsTable__header-cell">city</th><th class="ResultsTable__header-cell">address</th><th class="ResultsTable__header-cell">phone_number</th></tr></thead><tbody><tr class="ResultsTable__row "><td class="ResultsTable__cell">8</td><td class="ResultsTable__cell">John</td><td class="ResultsTable__cell">Joseph</td><td class="ResultsTable__cell">San Francisco</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">928-386-8164</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">7</td><td class="ResultsTable__cell">Jill</td><td class="ResultsTable__cell">Michael</td><td class="ResultsTable__cell">Austin</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">813-297-0692</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">4</td><td class="ResultsTable__cell">William</td><td class="ResultsTable__cell">Daniel</td><td class="ResultsTable__cell">Denver</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">813-368-1200</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">5</td><td class="ResultsTable__cell">Henry</td><td class="ResultsTable__cell">Jackson</td><td class="ResultsTable__cell">Miami</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">808-601-7513</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">13</td><td class="ResultsTable__cell">Emma</td><td class="ResultsTable__cell">Isaac</td><td class="ResultsTable__cell">Miami</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">808-690-5201</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">14</td><td class="ResultsTable__cell">Liam</td><td class="ResultsTable__cell">Samuel</td><td class="ResultsTable__cell">Miami</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">808-555-5201</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">15</td><td class="ResultsTable__cell">Mia</td><td class="ResultsTable__cell">Owen</td><td class="ResultsTable__cell">Miami</td><td class="ResultsTable__cell"></td><td class="ResultsTable__cell">808-640-5201</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">1</td><td class="ResultsTable__cell">Mark</td><td class="ResultsTable__cell">Thomas</td><td class="ResultsTable__cell">Arizona</td><td class="ResultsTable__cell">4476 Parkway Drive</td><td class="ResultsTable__cell">602-993-5916</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">12</td><td class="ResultsTable__cell">Eva</td><td class="ResultsTable__cell">Lucas</td><td class="ResultsTable__cell">Arizona</td><td class="ResultsTable__cell">4379 Skips Lane</td><td class="ResultsTable__cell">301-509-8805</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">6</td><td class="ResultsTable__cell">Jack</td><td class="ResultsTable__cell">Aiden</td><td class="ResultsTable__cell">Arizona</td><td class="ResultsTable__cell">4833 Coplin Avenue</td><td class="ResultsTable__cell">480-303-1527</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">2</td><td class="ResultsTable__cell">Mona</td><td class="ResultsTable__cell">Adrian</td><td class="ResultsTable__cell">Los Angeles</td><td class="ResultsTable__cell">1958 Peck Court</td><td class="ResultsTable__cell">714-409-9432</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">10</td><td class="ResultsTable__cell">Lili</td><td class="ResultsTable__cell">Oliver</td><td class="ResultsTable__cell">Los Angeles</td><td class="ResultsTable__cell">3832 Euclid Avenue</td><td class="ResultsTable__cell">530-695-1180</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">3</td><td class="ResultsTable__cell">Farida</td><td class="ResultsTable__cell">Joseph</td><td class="ResultsTable__cell">San Francisco</td><td class="ResultsTable__cell">3153 Rhapsody Street</td><td class="ResultsTable__cell">813-368-1200</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">9</td><td class="ResultsTable__cell">Justin</td><td class="ResultsTable__cell">Alexander</td><td class="ResultsTable__cell">Denver</td><td class="ResultsTable__cell">4470 McKinley Avenue</td><td class="ResultsTable__cell">970-433-7589</td></tr><tr class="ResultsTable__row "><td class="ResultsTable__cell">11</td><td class="ResultsTable__cell">Frank</td><td class="ResultsTable__cell">Jacob</td><td class="ResultsTable__cell">Miami</td><td class="ResultsTable__cell">1299 Randall Drive</td><td class="ResultsTable__cell">808-590-5201</td></tr></tbody></table></div>



위와 같이 customers 테이블의 address 컬럼 값이 NULL 아니면 주소값이여서 아래와 같이 코드를 작성했다.

```sql
select count(address)/count(*) * 100 as percent_shipable
from orders a
join customers b
on a.cust_id = b.id;
```
MySQL에서 NULL값을 제외한 후 count되기에 위와 같이 코드를 작성했다.

그러나 이 접근 방식은 address 컬럼이 빈 문자열('')로 표시되는 경우를 올바르게 처리하지 못할 수 있다. 
빈 문자열은 NULL이 아니므로 count(address)에 포함되기 때문이다.

Gemma 님의 피드백을 통해 아래와 같이 코드를 수정할 수 있다.
```sql
select sum(case when address!='' then 1 else 0 end)/count(*)*100
from orders as t1
inner join customers as t2
on t1.cust_id=t2.id;
```


이를 통해 범용적인 상황에서 좀 더 명확히 원하는 결과값을 찾을 수 있다.


